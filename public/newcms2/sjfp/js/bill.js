$(function(){var e=$("#bill-btn"),t=$("#bill-content"),l=$("#container"),s=$("#userInfo"),i="",n="",a="",r=0,o=bn_utils.getLocalStore("token")||"",c=bn_utils.getLocalStore("user_id")||"",d=bn_utils.getLocalStore("user_name")||"";function u(e){bn_utils.loadingEnd();var t=e.content,l="";if(1==e.ret){var i=$("#bill-content ul");if(i.children().remove(),t.length){for(var n=0;n<t.length;n++)l+='<li><div class="bill-mun-title flex-btw-cen bill-title"><span>订单号</span><div class="list-select"></div></div><div class="bill-mun">'+t[n].order_sn+'</div><div class="bill-data-title bill-title">充值日期</div><div class="bill-data">'+t[n].update_time.split(" ")[0].replace(/-/g,"/")+'</div><div class="bill-free-title bill-title">充值金额</div><div class="bill-free">'+t[n].money+"</div>";$(".select-tip").text("请勾选您所需要开发票的订单信息")}else l='<li style="text-align:center;font-size:.4rem;border:none;">无充值记录</li>';i.append(l),$(".select-all").data("select",!1).text("全选")}else bn_utils.tipModal("fail",e.msg)}function b(e){return e=e.split("-"),Number(e[1])<10&&(e[1]="0"+Number(e[1])),Number(e[2])<10&&(e[2]="0"+Number(e[2])),e.join("-")}function f(e){bn_utils.tipModal("success",e.message),s.hide(),l.show()}function m(e){302==e.status?(bn_utils.tipModal("fail",JSON.parse(e.responseText).message),s.hide(),l.show()):alert(e.status+" "+e.statusText)}o&&c||(location.href="https://www.310game.com/newcms2/sjfp/index.html"),$.selectDate("#time-start",{start:2015,end:2030,select:[2016,1,1],title:"起始时间"},function(e){i=e.year+"-"+e.month+"-"+e.day}),$.selectDate("#tiem-end",{start:2015,end:2030,select:[2018,1,1],title:"截止时间"},function(e){if(n=e.year+"-"+e.month+"-"+e.day,Date.parse(i)>Date.parse(n)||!i)return bn_utils.tipModal("fail","请选择正确的时间区间"),!1;var t=new FormData;t.append("token",o),t.append("user_id",c),t.append("start",b(i)),t.append("end",b(n)),queryOrder(t,u)}),e.find(".sub-btn").on("click",function(){var i=[],n=0;if(!$(".list-selected").length)return bn_utils.tipModal("fail","您未选中订单!"),!1;$(".list-content .list-selected").each(function(e,t){var l=$(t).parent();i.push(l.siblings(".bill-mun").text()),n+=Number(l.siblings(".bill-free").text())}),a=i.join(","),r=n,$("#sum_money").text(n),l.hide(),s.show()}),e.find(".select-all").on("click",function(){var e=$(this),t=e.data("select"),l=$(".list-select");if(!l.length)return bn_utils.tipModal("fail","无订单可选"),!1;t?(e.data("select",!1).text("全 选"),l.removeClass("list-selected")):(l.addClass("list-selected"),e.data("select",!0).text("取消全选"))}),t.on("click",".bill-mun-title",function(){var e=$(this).find(".list-select");e.hasClass("list-selected")?e.removeClass("list-selected"):e.addClass("list-selected")}),$(".info-btn").on("click",function(){var e=$(".info-email input").val().trim(),t=$(".info-name input").val().trim(),l=$(".info-tel input").val().trim();return 1!=bn_utils.checkEmailFormat(e)?(bn_utils.tipModal("fail","请输入正确的邮箱！"),!1):t?1!=bn_utils.checkPhoneFormat(l)?(bn_utils.tipModal("fail","请输入正确的手机号！"),!1):void apply_bill_request({user_name:d,user_id:c,name:t,email:e,phone:l,orders:a,money:r},f,m):(bn_utils.tipModal("fail","请输入姓名！"),!1)}),s.find(".info-return").on("click",function(){s.hide(),l.show()})});
//# sourceMappingURL=bill.js.map
